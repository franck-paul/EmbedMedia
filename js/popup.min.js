"use strict";dotclear.ready((()=>{Object.assign(dotclear,dotclear.getData("embed_media",!1,!1));const e=document.querySelector("#media-insert-form");if(!e)return;const t=t=>{t?.preventDefault(),t?.stopPropagation();const r=e.querySelector("#media-insert-url").value;if(!r)return void window.alert(dotclear.embed_media.url_empty);const a=document.querySelector(".ac_waiting");a&&(a.style.width="4em");const i=Number.parseInt(e.querySelector("#media-insert-maxwidth")?.value),n=Number.parseInt(e.querySelector("#media-insert-maxheight")?.value);dotclear.jsonServicesGet("embedMedia",(i=>{if(!1===i.ret)return a&&a.classList.remove("ac_loading"),t?.preventDefault(),t?.stopPropagation(),void(i?.error?window.alert(`${dotclear.embed_media.request_error} ${i.error}`):window.alert(`${dotclear.embed_media.unknown_error}`));((t,r)=>{const a=window.opener.the_toolbar,{data:i}=a.elements.embedmedia;i.alignment=e.querySelector('input[name="media-insert-alignment"]:checked')?.value,i.url=r,i.m_object=t,i.caption=e.querySelector('input[name="media-insert-caption"]')?.value,a.elements.embedmedia.fncall[a.mode].call(a),window.close()})(i.html,r)}),{url:r,maxwidth:i,maxheight:n},(e=>{a&&a.classList.remove("ac_loading")})),a&&a.classList.add("ac_loading")};document.querySelector("#media-insert-cancel")?.addEventListener("click",(e=>{e?.preventDefault(),window.close()})),document.querySelector("#media-insert-ok")?.addEventListener("click",(e=>{t(e)})),e.addEventListener("submit",(e=>{t(e)})),dotclear.enterKeyInForm("#media-insert-form","#media-insert-ok","#media-insert-cancel")}));
